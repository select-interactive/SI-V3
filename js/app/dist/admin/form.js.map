{"version":3,"sources":["../../admin/form.js"],"names":["doc","config","btnBack","btnDelete","btnNew","btnSave","formGrid","formEdit","gridContainerId","gridRowClass","hiddenClass","lblItem","lblItems","wsUrl","toast","app","Toast","alert","Alert","defaultUrl","window","location","pathname","AdminForm","options","labelItemText","labelItemsText","initItemFn","initItem","callback","loadItemsFn","loadItems","fn","loadItemsParams","params","loadItemsRowHTML","rowTmpl","loadItemsRowHeaders","rowTmplHeaders","loadItemsRowProps","rowTmplProps","editItemFn","editItem","editItemParams","editItemItemId","itemId","editItemCallback","saveItemFn","saveItem","saveItemId","sendAsString","saveCallback","deleteItemFn","deleteItem","deleteItemItemId","backToGridCallback","back","items","Form","$","additionadditionalPropertiesDefault","util","cloneObj","additionalProperties","setLabels","bind","buildGrid","initNewItem","editData","backToGrid","btnDeleteClickHandler","popstateHanlder","addEventListeners","me","forEach","el","textContent","addEventListener","fetch","body","then","rsp","success","obj","catch","console","log","html","rowHtml","i","length","hdr","itemProp","replace","item","j","val","innerHTML","setTimeout","FormRow","row","container","querySelector","value","hide","show","classList","add","history","pushState","page","id","setFieldValues","remove","Object","getOwnPropertyNames","scrollTo","isValid","validateFields","collectData","data","JSON","stringify","clearForm","promptAlert","dismissAlert","msg","evt","preventDefault","key","e","state","file","isImg","handler","headers","fileName","name","fileType","type","fReader","FileReader","test","onload","xhr","XMLHttpRequest","open","setRequestHeader","size","response","target","parse","send","readAsDataURL","form","getAttribute","btnEdit","document"],"mappings":"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","file":"form.js","sourcesContent":["﻿///<reference path=\"main.js\">\r\n/**\r\n * Copyright 2016 Select Interactive, LLC. All rights reserved.\r\n * @author: The Select Interactive dev team (www.select-interactive.com) \r\n * \r\n * Configuration/Info\r\n * \r\n * Label for item has class lbl-item\r\n * Label for items has class lbl-items\r\n * For grid, expects grid container to have ID grid-container\r\n * Expects form-grid for item listing\r\n * Expects form-edit for manipulating item data\r\n * \r\n * Expects add new button with ID btn-new\r\n */\r\n( function( doc ) {\r\n\t'use strict';\r\n\r\n\tconst config = {\r\n\t\tbtnBack: 'btn-back',\r\n\t\tbtnDelete: 'btn-delete',\r\n\t\tbtnNew: 'btn-new',\r\n\t\tbtnSave: 'btn-save',\r\n\t\tformGrid: 'form-grid',\r\n\t\tformEdit: 'form-edit',\r\n\t\tgridContainerId: 'grid-container',\r\n\t\tgridRowClass: 'admin-grid-row',\r\n\t\thiddenClass: 'hidden',\r\n\t\tlblItem: 'lbl-item',\r\n\t\tlblItems: 'lbl-items',\r\n\t\twsUrl: '/api/'\r\n\t};\r\n\r\n\tconst toast = new app.Toast();\r\n\tconst alert = new app.Alert();\r\n\tconst defaultUrl = window.location.pathname;\r\n\t\r\n\tclass AdminForm {\r\n\t\tconstructor( options ) {\r\n\t\t\t// extract data from options\r\n\t\t\tthis.options = options;\r\n\r\n\t\t\tthis.labelItemText = options.labelItemText;\r\n\t\t\tthis.labelItemsText = options.labelItemsText;\r\n\r\n\t\t\t// init new item\r\n\t\t\tthis.initItemFn = options.initItem ? options.initItem.callback : null;\r\n\r\n\t\t\t// load items information\r\n\t\t\tthis.loadItemsFn = options.loadItems.fn;\r\n\t\t\tthis.loadItemsParams = options.loadItems.params;\r\n\t\t\tthis.loadItemsRowHTML = options.loadItems.rowTmpl;\r\n\t\t\tthis.loadItemsRowHeaders = options.loadItems.rowTmplHeaders;\r\n\t\t\tthis.loadItemsRowProps = options.loadItems.rowTmplProps;\r\n\t\t\t\r\n\t\t\t// edit item options\r\n\t\t\tthis.editItemFn = options.editItem.fn;\r\n\t\t\tthis.editItemParams = options.editItem.params;\r\n\t\t\tthis.editItemItemId = options.editItem.itemId;\r\n\t\t\tthis.editItemCallback = options.editItem.callback;\r\n\r\n\t\t\t// save item\r\n\t\t\tthis.saveItemFn = options.saveItem.fn;\r\n\t\t\tthis.saveItemId = options.saveItem.itemId;\r\n\t\t\tthis.sendAsString = options.saveItem.sendAsString || false;\r\n\t\t\tthis.saveCallback = options.saveItem.callback;\r\n\r\n\t\t\t// delete item\r\n\t\t\tthis.deleteItemFn = options.deleteItem.fn;\r\n\t\t\tthis.deleteItemItemId = options.deleteItem.itemId;\r\n\r\n\t\t\t// back to options callback\r\n\t\t\tthis.backToGridCallback = options.back.fn;\r\n\r\n\t\t\t// items\r\n\t\t\tthis.items = [];\r\n\r\n\t\t\t// initialize our form objects\r\n\t\t\tthis.formGrid = new app.Form( app.$( '#' + config.formGrid ) );\r\n\t\t\tthis.formEdit = new app.Form( app.$( '#' + config.formEdit ) );\r\n\r\n\t\t\t// buttons\r\n\t\t\tthis.btnNew = app.$( '#' + config.btnNew );\r\n\t\t\tthis.btnBack = app.$( '#' + config.btnBack );\r\n\t\t\tthis.btnDelete = app.$( '#' + config.btnDelete );\r\n\t\t\tthis.btnSave = app.$( '#' + config.btnSave );\r\n\r\n\t\t\t// tracking data \r\n\t\t\tthis.itemId = -1;\r\n\t\t\tthis.additionadditionalPropertiesDefault = app.util.cloneObj( options.additionalProperties || {} );\r\n\t\t\tthis.additionalProperties = app.util.cloneObj( options.additionalProperties || {} );\r\n\r\n\t\t\t// bind this to our functions\r\n\t\t\tthis.setLabels = this.setLabels.bind( this );\r\n\t\t\tthis.loadItems = this.loadItems.bind( this );\r\n\t\t\tthis.buildGrid = this.buildGrid.bind( this );\r\n\t\t\tthis.initNewItem = this.initNewItem.bind( this );\r\n\t\t\tthis.editData = this.editData.bind( this );\r\n\t\t\tthis.saveItem = this.saveItem.bind( this );\r\n\t\t\tthis.backToGrid = this.backToGrid.bind( this );\r\n\t\t\tthis.btnDeleteClickHandler = this.btnDeleteClickHandler.bind( this );\r\n\t\t\tthis.deleteItem = this.deleteItem.bind( this );\r\n\t\t\tthis.popstateHanlder = this.popstateHanlder.bind( this );\r\n\r\n\t\t\t// set display labels\r\n\t\t\tthis.setLabels();\r\n\r\n\t\t\t// assign event listeners\r\n\t\t\tthis.addEventListeners();\r\n\r\n\t\t\t// load current database items\r\n\t\t\tthis.loadItems();\r\n\t\t}\r\n\r\n\t\tsetLabels() {\r\n\t\t\tconst me = this;\r\n\r\n\t\t\tapp.$.forEach( '.' + config.lblItem, el => {\r\n\t\t\t\tel.textContent = me.labelItemText;\r\n\t\t\t} );\r\n\r\n\t\t\tapp.$.forEach( '.' + config.lblItems, el => {\r\n\t\t\t\tel.textContent = me.labelItemsText;\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\taddEventListeners() {\r\n\t\t\tthis.btnNew.addEventListener( 'click', this.initNewItem, false );\r\n\t\t\tthis.btnBack.addEventListener( 'click', this.backToGrid, false );\r\n\t\t\tthis.btnSave.addEventListener( 'click', this.saveItem, false );\r\n\t\t\tthis.btnDelete.addEventListener( 'click', this.btnDeleteClickHandler, false );\r\n\r\n\t\t\twindow.addEventListener( 'popstate', this.popstateHanlder, false );\r\n\t\t}\r\n\r\n\t\tloadItems() {\r\n\t\t\tapp.$.fetch( config.wsUrl + this.loadItemsFn, {\r\n\t\t\t\tbody: this.loadItemsParams\r\n\t\t\t} ).then( rsp => {\r\n\t\t\t\tif ( rsp.success ) {\r\n\t\t\t\t\tthis.items = rsp.obj;\r\n\t\t\t\t\tthis.buildGrid();\r\n\t\t\t\t}\r\n\t\t\t} ).catch( rsp => {\r\n\t\t\t\tconsole.log( 'Error loading items.', rsp );\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tbuildGrid() {\r\n\t\t\tconst me = this;\r\n\t\t\tlet html = '';\r\n\t\t\tlet rowHtml = '';\r\n\r\n\t\t\t// add the header row\r\n\t\t\trowHtml = this.loadItemsRowHTML;\r\n\t\t\tfor ( let i = 0; i < this.loadItemsRowHeaders.length; i++ ) {\r\n\t\t\t\tlet hdr = this.loadItemsRowHeaders[i];\r\n\t\t\t\tlet itemProp = this.loadItemsRowProps[i];\r\n\t\t\t\trowHtml = rowHtml.replace( '{{' + itemProp + '}}', hdr );\r\n\t\t\t}\r\n\r\n\t\t\trowHtml = rowHtml.replace( '{{rowClass}}', ' hdr' );\r\n\t\t\thtml += rowHtml;\r\n\r\n\t\t\t// loop through all of the items and add them\r\n\t\t\tfor ( let i = 0; i < this.items.length; i++ ) {\r\n\t\t\t\tlet item = this.items[i];\r\n\t\t\t\trowHtml = this.loadItemsRowHTML.replace( '{{rowClass}}', '' );\r\n\t\t\t\t\r\n\t\t\t\tfor ( let j = 0; j < this.loadItemsRowProps.length; j++ ) {\r\n\t\t\t\t\tlet itemProp = this.loadItemsRowProps[j];\r\n\t\t\t\t\tlet val = item[itemProp];\r\n\r\n\t\t\t\t\tif ( itemProp === 'active' ) {\r\n\t\t\t\t\t\tval = val === true ? 'Active' : 'Not Active';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trowHtml = rowHtml.replace( '{{' + itemProp + '}}', val );\r\n\t\t\t\t}\r\n\r\n\t\t\t\thtml += rowHtml;\r\n\t\t\t}\r\n\r\n\t\t\tapp.$( '#' + config.gridContainerId ).innerHTML = html;\r\n\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tapp.$.forEach( '.' + config.gridRowClass, row => {\r\n\t\t\t\t\tnew FormRow( row, me  );\r\n\t\t\t\t} );\r\n\t\t\t}, 10 );\r\n\t\t}\r\n\r\n\t\tinitNewItem() {\r\n\t\t\tthis.itemId = -1;\r\n\r\n\t\t\tif ( this.formEdit.container.querySelector( '#tb-sort-order' ) ) {\r\n\t\t\t\tthis.formEdit.container.querySelector( '#tb-sort-order' ).value = this.items.length + 1;\r\n\t\t\t}\r\n\r\n\t\t\tthis.formGrid.hide();\r\n\t\t\tthis.formEdit.show();\r\n\t\t\tthis.btnDelete.classList.add( config.hiddenClass );\r\n\r\n\t\t\tif ( this.initItemFn && typeof this.initItemFn === 'function' ) {\r\n\t\t\t\tthis.initItemFn();\r\n\t\t\t}\r\n\r\n\t\t\thistory.pushState( { page: 'edit' }, 'Edit', '?edit' );\r\n\t\t}\r\n\r\n\t\teditData( id ) {\r\n\t\t\ttoast.show( 'Loading item details...', -1 );\r\n\t\t\tthis.itemId = id;\r\n\t\t\tthis.editItemParams[this.editItemItemId] = this.itemId;\r\n\t\t\t\r\n\t\t\tapp.$.fetch( config.wsUrl + this.editItemFn, {\r\n\t\t\t\tbody: this.editItemParams\r\n\t\t\t} ).then( rsp => {\r\n\t\t\t\tlet obj;\r\n\r\n\t\t\t\tif ( rsp.success && rsp.obj.length ) {\r\n\t\t\t\t\tobj = rsp.obj[0];\r\n\t\t\t\t\tthis.formEdit.setFieldValues( obj );\r\n\t\t\t\t\tthis.formEdit.show();\r\n\t\t\t\t\tthis.formGrid.hide();\r\n\t\t\t\t\tthis.btnDelete.classList.remove( config.hiddenClass );\r\n\r\n\t\t\t\t\tif ( this.additionalProperties ) {\r\n\t\t\t\t\t\tObject.getOwnPropertyNames( this.additionalProperties ).forEach( val => {\r\n\t\t\t\t\t\t\tthis.additionalProperties[val] = obj[val];\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\twindow.scrollTo( 0, 0 );\r\n\t\t\t\t\ttoast.hide( true );\r\n\r\n\t\t\t\t\tif ( this.editItemCallback && typeof this.editItemCallback === 'function' ) {\r\n\t\t\t\t\t\tthis.editItemCallback( obj );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thistory.pushState( { page: 'edit' }, 'Edit', '?edit' );\r\n\t\t\t\t}\r\n\t\t\t} ).catch( rsp => {\r\n\t\t\t\tconsole.log( rsp );\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tsaveItem() {\r\n\t\t\tconst me = this;\r\n\t\t\tlet isValid = this.formEdit.validateFields();\r\n\t\t\tlet params = {};\r\n\r\n\t\t\tif ( !isValid ) {\r\n\t\t\t\ttoast.show( 'Fields marked with * are required.' );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\ttoast.show( 'Saving data, please wait...' );\r\n\r\n\t\t\tparams = this.formEdit.collectData();\r\n\r\n\t\t\tif ( this.additionalProperties ) {\r\n\t\t\t\tObject.getOwnPropertyNames( this.additionalProperties ).forEach( val => {\r\n\t\t\t\t\tparams[val] = this.additionalProperties[val];\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tparams[this.saveItemId] = this.itemId;\r\n\r\n\t\t\tif ( this.sendAsString ) {\r\n\t\t\t\tparams = {\r\n\t\t\t\t\tdata: JSON.stringify( params )\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tapp.$.fetch( config.wsUrl + this.saveItemFn, {\r\n\t\t\t\tbody: params\r\n\t\t\t} ).then( rsp => {\r\n\t\t\t\tif ( rsp.success ) {\r\n\t\t\t\t\ttoast.show( 'Data saved successfully.', 2000 );\r\n\t\t\t\t\tme.loadItems();\r\n\r\n\t\t\t\t\tif ( this.itemId === -1 ) {\r\n\t\t\t\t\t\t//setTimeout( me.backToGrid, 1500 );\r\n\t\t\t\t\t\tthis.itemId = rsp.obj;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.saveCallback && typeof this.saveCallback === 'function' ) {\r\n\t\t\t\t\t\tthis.saveCallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttoast.show( 'Unable to save at this time, please try again.', -1 );\r\n\t\t\t\t\tconsole.log( 'Error:', rsp || 'No error data.' );\r\n\t\t\t\t}\r\n\t\t\t} ).catch( rsp => {\r\n\t\t\t\ttoast.show( 'Unable to save at this time, please try again.', -1 );\r\n\t\t\t\tconsole.log( 'Error:', rsp || 'No error data.' );\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tbackToGrid() {\r\n\t\t\tthis.formEdit.hide();\r\n\t\t\tthis.formEdit.clearForm();\r\n\t\t\tthis.formGrid.show();\r\n\r\n\t\t\t// reset tracked data\r\n\t\t\tthis.itemId = -1;\r\n\r\n\t\t\tif ( this.additionalProperties ) {\r\n\t\t\t\tObject.getOwnPropertyNames( this.additionalProperties ).forEach( val => {\r\n\t\t\t\t\tthis.additionalProperties[val] = this.additionadditionalPropertiesDefault[val];\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.backToGridCallback && typeof this.backToGridCallback === 'function' ) {\r\n\t\t\t\tthis.backToGridCallback();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\twindow.scrollTo( 0, 0 );\r\n\r\n\t\t\thistory.pushState( { page: '' }, 'Options', defaultUrl );\r\n\t\t}\r\n\r\n\t\tbtnDeleteClickHandler() {\r\n\t\t\tthis.deleteItem( this.itemId );\r\n\t\t}\r\n\r\n\t\tdeleteItem( id ) {\r\n\t\t\tconst me = this;\r\n\r\n\t\t\tlet params = {};\r\n\t\t\tparams[this.deleteItemItemId] = id;\r\n\r\n\t\t\talert.promptAlert( 'Confirm Delete', '<p>Are you sure you want to delete this item?', 'Delete', 'Cancel', evt => {\r\n\t\t\t\talert.dismissAlert();\r\n\t\t\t\ttoast.show( 'Deleting item...' );\r\n\t\t\t\t\r\n\t\t\t\tapp.$.fetch( config.wsUrl + this.deleteItemFn, {\r\n\t\t\t\t\tbody: params\r\n\t\t\t\t} ).then( rsp => {\r\n\t\t\t\t\tif ( rsp.success ) {\r\n\t\t\t\t\t\ttoast.show( 'Item successfully deleted.', 2500 );\r\n\t\t\t\t\t\tme.loadItems();\r\n\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tme.backToGrid();\r\n\t\t\t\t\t\t}, 1000 );\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttoast.show( 'Unable to delete at this time. Please try again.' );\r\n\t\t\t\t\t\tconsole.log( 'Error:', rsp.msg || 'No error data' );\r\n\t\t\t\t\t}\r\n\t\t\t\t} ).catch( rsp => {\r\n\t\t\t\t\ttoast.show( 'Unable to delete at this time. Please try again.' );\r\n\t\t\t\t\tconsole.log( 'Error:', rsp || 'No error data' );\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tevt.preventDefault();\r\n\t\t\t}, evt => {\r\n\t\t\t\talert.dismissAlert();\r\n\t\t\t\tevt.preventDefault();\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tsetAdditionalPropertyData( key, val ) {\r\n\t\t\tthis.additionalProperties[key] = val;\r\n\t\t}\r\n\r\n\t\tgetAdditionalPropertyData( key ) {\r\n\t\t\treturn this.additionalProperties[key];\r\n\t\t}\r\n\r\n\t\tpopstateHanlder( e ) {\r\n\t\t\tif ( !e.state || e.state.page === '' ) {\r\n\t\t\t\tthis.backToGrid();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// helper function to handle image uploads\r\n\t\t//   @file - the file to be uploaded\r\n\t\t//   @isImg - boolean if uploading an image\r\n\t\t//   @handler - the ashx file to handle the file upload\r\n\t\t//   @fn - optional - callback function to run after the image has been uploaded\r\n\t\tuploadHelper( file, isImg, handler, headers, fn ) {\r\n\t\t\tlet fileName = file.name;\r\n\t\t\tlet fileType = file.type;\r\n\t\t\tlet fReader = new FileReader();\r\n\r\n\t\t\t// confirm this file is allowed\r\n\t\t\tif ( !isImg || /^image\\//.test( fileType ) ) {\r\n\t\t\t\ttoast.show( 'Uploading file, please wait...', -1 );\r\n\r\n\t\t\t\tfReader.onload = function( e ) {\r\n\t\t\t\t\tlet xhr = new XMLHttpRequest();\r\n\r\n\t\t\t\t\t// set the handler and all headers\r\n\t\t\t\t\txhr.open( 'post', handler, true );\r\n\t\t\t\t\txhr.setRequestHeader( 'X-File-Name', fileName );\r\n\t\t\t\t\txhr.setRequestHeader( 'X-File-Size', file.size );\r\n\t\t\t\t\txhr.setRequestHeader( 'X-File-Type', fileType );\r\n\r\n\t\t\t\t\tfor ( const key in headers ) {\r\n\t\t\t\t\t\txhr.setRequestHeader( key, headers[key] );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// callback of xhr load\r\n\t\t\t\t\txhr.addEventListener( 'load', function( response ) {\r\n\t\t\t\t\t\t// when the request is complete\r\n\t\t\t\t\t\tif ( response.target.response ) {\r\n\t\t\t\t\t\t\tlet rsp = JSON.parse( response.target.response );\r\n\r\n\t\t\t\t\t\t\t// if the upload was successful\r\n\t\t\t\t\t\t\tif ( rsp.success ) {\r\n\t\t\t\t\t\t\t\ttoast.show( 'The file was successfully uploaded.' );\r\n\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\ttoast.hide( true );\r\n\t\t\t\t\t\t\t\t}, 1000 );\r\n\r\n\t\t\t\t\t\t\t\tif ( fn && typeof fn === 'function' ) {\r\n\t\t\t\t\t\t\t\t\tfn( rsp.obj );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\ttoast.show( 'Unable to upload the file, please try again.', -1 );\r\n\t\t\t\t\t\t\t\tconsole.log( 'Error:', rsp.msg || 'No error data.' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, false );\r\n\r\n\t\t\t\t\txhr.send( file );\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// begin the read operation\r\n\t\t\t\tfReader.readAsDataURL( file );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttoast.show( 'Only .jpg, .jpeg, and .png files are allowed.', -1 );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclass FormRow {\r\n\t\tconstructor( row, form ) {\r\n\t\t\tthis.container = row;\r\n\t\t\tthis.AdminForm = form;\r\n\t\t\tthis.id = row.getAttribute( 'data-id' );\r\n\t\t\tthis.btnEdit = row.querySelector( '.btn-edit' );\r\n\t\t\tthis.btnDelete = row.querySelector( '.btn-delete' );\r\n\t\t\t\r\n\t\t\tthis.editItem = this.editItem.bind( this );\r\n\t\t\tthis.deleteItem = this.deleteItem.bind( this );\r\n\r\n\t\t\tthis.addEventListeners();\r\n\t\t}\r\n\r\n\t\taddEventListeners() {\r\n\t\t\tthis.btnEdit.addEventListener( 'click', this.editItem, false );\r\n\t\t\tthis.btnDelete.addEventListener( 'click', this.deleteItem, false );\r\n\t\t}\r\n\r\n\t\teditItem() {\r\n\t\t\tthis.AdminForm.editData( this.id );\r\n\t\t}\r\n\r\n\t\tdeleteItem() {\r\n\t\t\tthis.AdminForm.deleteItem( this.id );\r\n\t\t}\r\n\t}\r\n\r\n\tapp.AdminForm = AdminForm;\r\n\r\n}( document ) );"]}