"use strict";!function(a){function b(a){app.$.fetch("/api/projectTagsGetJson",{body:{tagId:-1,projectId:a.projectId}}).then(function(a){if(a.success){var b=a.obj;b.forEach(function(a){app.$.forEach(i.children,function(b){a.tagId===parseInt(b.value,10)&&(b.selected=!0)})}),j.trigger("chosen:updated")}}),app.$.fetch("/api/industriesGetJson",{body:{industryId:-1,projectId:a.projectId}}).then(function(a){if(a.success){var b=a.obj;b.forEach(function(a){app.$.forEach(k.children,function(b){a.industryId===parseInt(b.value,10)&&(b.selected=!0)})}),l.trigger("chosen:updated")}}),app.$.fetch("/api/partnersGetJson",{body:{partnerId:-1,projectId:a.projectId}}).then(function(a){if(a.success){var b=a.obj;b.forEach(function(a){app.$.forEach(m.children,function(b){a.partnerId===parseInt(b.value,10)&&(b.selected=!0)})}),n.trigger("chosen:updated")}}),d(h.getAdditionalPropertyData("imgPath")),c(h.getAdditionalPropertyData("gridImgPath"))}function c(a){return""===a?(q.innerHTML="",void r.classList.add("hidden")):(q.innerHTML='<img src="'+a+'" />',void r.classList.remove("hidden"))}function d(a){return""===a?(x.innerHTML="",void y.classList.add("hidden")):(x.innerHTML='<img src="'+a+'" />',void y.classList.remove("hidden"))}function e(){var a=[],b=[],c=[];app.$.forEach(i.children,function(b){b.selected&&a.push(b.value)}),app.$.forEach(k.children,function(a){a.selected&&b.push(a.value)}),app.$.forEach(m.children,function(a){a.selected&&c.push(a.value)}),app.$.fetch("/api/projectsTagsAssign",{body:{projectId:h.itemId,tags:a}}),app.$.fetch("/api/projectsIndustriesAssign",{body:{projectId:h.itemId,industries:b}}),app.$.fetch("/api/projectsPartnersAssign",{body:{projectId:h.itemId,partners:c}})}function f(){app.$.forEach(i.children,function(a){a.selected=!1}),app.$.forEach(k.children,function(a){a.selected=!1}),app.$.forEach(m.children,function(a){a.selected=!1}),j.trigger("chosen:updated"),l.trigger("chosen:updated"),n.trigger("chosen:updated"),c(""),d("")}var g=new app.Alert,h=new app.AdminForm({labelItemText:"Project",labelItemsText:"Projects",loadItems:{fn:"projectsGetJson",params:{projectId:-1},rowTmpl:'<div class="admin-grid-row{{rowClass}}" data-id="{{projectId}}"><div class="admin-grid-col admin-grid-col-primary">{{name}}</div><div class="admin-grid-col">{{active}}</div><div class="admin-grid-col"><button class="btn btn-ripple btn-edit">Edit</button><button class="btn btn-ripple btn-delete">Delete</button></div></div>',rowTmplHeaders:["","Name","Active"],rowTmplProps:["projectId","name","active"]},editItem:{fn:"projectsGetJson",params:{},itemId:"projectId",callback:b},saveItem:{fn:"projectSave",itemId:"projectId",sendAsString:!0,callback:e},deleteItem:{fn:"projectDelete",itemId:"projectId"},back:{fn:f},additionalProperties:{imgPath:"",imgFileName:"",gridImgPath:"",gridImgFileName:""}}),i=app.$("#ddl-tags"),j=$(i),k=app.$("#ddl-industries"),l=$(k),m=app.$("#ddl-partners"),n=$(m);j.chosen(),l.chosen(),n.chosen();var o=app.$("#btn-upload-grid-img"),p=app.$("#f-upload-grid-img"),q=app.$("#prev-grid-img"),r=app.$("#btn-grid-img-delete"),s="img/projects/",t=1e3,u=590,v=app.$("#btn-upload-img"),w=app.$("#f-upload-img"),x=app.$("#prev-img"),y=app.$("#btn-img-delete"),z="img/projects/",A=1e3,B=762;o.addEventListener("click",function(a){return p.click()}),p.addEventListener("change",function(a){var b=a.dataTransfer?a.dataTransfer.files:a.currentTarget.files,d=b[0];h.uploadHelper(d,!0,"/admin/uploadImg.ashx",{"X-Min-Width":t,"X-Min-Height":u,"X-File-Path":s},function(a){a&&(h.setAdditionalPropertyData("gridImgPath",a.filePath),h.setAdditionalPropertyData("gridImgFileName",a.fileName),c(a.filePath)),p.value=""})}),r.addEventListener("click",function(a){g.promptAlert("Confirm Delete","<p>Are you sure you want to delete this image?","Delete","Cancel",function(a){h.setAdditionalPropertyData("gridImgPath",""),h.setAdditionalPropertyData("gridImgFileName",""),c(""),g.dismissAlert(),a.preventDefault()},function(a){g.dismissAlert(),a.preventDefault()})}),v.addEventListener("click",function(a){return w.click()}),w.addEventListener("change",function(a){var b=a.dataTransfer?a.dataTransfer.files:a.currentTarget.files,c=b[0];h.uploadHelper(c,!0,"/admin/uploadImg.ashx",{"X-Min-Width":A,"X-Min-Height":B,"X-File-Path":z},function(a){a&&(h.setAdditionalPropertyData("imgPath",a.filePath),h.setAdditionalPropertyData("imgFileName",a.fileName),d(a.filePath)),w.value=""})}),y.addEventListener("click",function(a){g.promptAlert("Confirm Delete","<p>Are you sure you want to delete this image?","Delete","Cancel",function(a){h.setAdditionalPropertyData("imgPath",""),h.setAdditionalPropertyData("imgFileName",""),d(""),g.dismissAlert(),a.preventDefault()},function(a){g.dismissAlert(),a.preventDefault()})})}(document);